# Some DeltaV rules
# alert udp any any -> $HOME_NET 18507 (msg:"DeltaV: Controller Told to Change Setpoint"; content:"|FA CE|"; startswith; content:"|00 02|"; offset:4; depth:6; content:"|0A 01|"; offset:16; depth:18; classtype:reconfiguration; sid:1234;)

# We're getting false alerts on the rule below, so disable it.
alert udp any any -> $HOME_NET 18507 (msg:"DeltaV: Controller Told to Change Setpoint"; content:"|0A 01|"; offset:16; depth:2; classtype:reconfiguration; sid:1234;)

# I want to know if new devices are connecting to an OPC UA server
alert tcp any any -> $HOME_NET 9409 (msg:"DeltaV: New OPC UA Connection"; content:"DvOpcUaServer"; classtype:recon; sid:1235;)


# Alert if the OPC UA server reports accepts having SecurityPolicy#None
alert tcp any any -> $HOME_NET 9409 (msg:"DeltaV: OPC UA No Security Policy"; content:"SecurityPolicy#None"; classtype:recon; sid:1236;)
alert tcp any any -> $HOME_NET 49320 (msg:"Kepware OPC UA No Security Policy"; content:"SecurityPolicy#None"; classtype:recon; sid:1236;)
alert tcp any any -> $HOME_NET 4840  (msg:"OPC UA No Security Policy"; content:"SecurityPolicy#None"; classtype:recon; sid:1236;)

