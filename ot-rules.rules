## -- DeltaV rules -----------------------------------------------
# DeltaV Minor: Controllers are told to change their setpoints
alert udp any any -> $HOME_NET 18507 (msg:"DeltaV: Controller Told to Change Setpoint"; content:"|0A 01|"; offset:16; depth:2; classtype:reconfiguration; sid:1234;)
# DeltaV Major: New downloads to stations (including operator, application, controllers)
alert udp any any -> $HOME_NET 18507 (msg:"DeltaV: ***ALERT STATION DOWNLOAD***"; content:"|08 01|"; offset:16; depth:2; classtype:reconfiguration; sid:1239;)


## -- OPC UA rules -----------------------------------------------
# I want to know if new devices are connecting to an OPC UA server
alert tcp any any -> $HOME_NET 9409 (msg:"DeltaV: New OPC UA Connection"; content:"DvOpcUaServer"; classtype:recon; sid:1235;)

# Alert if the OPC UA server reports accepts having SecurityPolicyNone
alert tcp any any -> $HOME_NET 9409 (msg:"DeltaV: OPC UA No Security Policy"; content:"SecurityPolicy|23|None"; classtype:recon; sid:1236;)
alert tcp any any -> $HOME_NET 49320 (msg:"Kepware OPC UA No Security Policy"; content:"SecurityPolicy|23|None"; classtype:recon; sid:1237;)
alert tcp any any -> $HOME_NET 4840  (msg:"OPC UA No Security Policy"; content:"SecurityPolicy|23|None"; classtype:recon; sid:1238;)

